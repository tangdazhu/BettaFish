# æ•°æ®åº“é…ç½®ç»Ÿä¸€è¯´æ˜

## ğŸ“‹ é—®é¢˜èƒŒæ™¯

ä¹‹å‰BettaFishé¡¹ç›®å­˜åœ¨**é…ç½®ç®¡ç†ä¸ç»Ÿä¸€**çš„é—®é¢˜ï¼š

1. **ä¸»é¡¹ç›®**ä½¿ç”¨ `.env` æ–‡ä»¶ + `pydantic-settings` ç®¡ç†é…ç½®
2. **MediaCrawlerå­é¡¹ç›®**ä½¿ç”¨ç¡¬ç¼–ç çš„ `db_config.py`
3. éœ€è¦åœ¨è¿è¡Œæ—¶åŠ¨æ€ä¿®æ”¹ `db_config.py` æ–‡ä»¶æ¥åŒæ­¥é…ç½®

## âœ… è§£å†³æ–¹æ¡ˆ

### ç»Ÿä¸€é…ç½®æº

**æ‰€æœ‰æ•°æ®åº“é…ç½®ç°åœ¨éƒ½ä» `.env` æ–‡ä»¶è¯»å–**ï¼š

```
d:\Python-Learning\bettafish\.env
â”œâ”€â”€ DB_HOST=localhost
â”œâ”€â”€ DB_PORT=5432
â”œâ”€â”€ DB_USER=bettafish
â”œâ”€â”€ DB_PASSWORD=bettafish_2024
â”œâ”€â”€ DB_NAME=bettafish
â””â”€â”€ DB_DIALECT=postgresql
```

### é…ç½®è¯»å–æ–¹å¼

#### 1. BettaFishä¸»é¡¹ç›®

ä½¿ç”¨ `config.py` + `pydantic-settings`ï¼š

```python
from config import settings

# ç›´æ¥ä½¿ç”¨
db_host = settings.DB_HOST
db_port = settings.DB_PORT
```

#### 2. MediaCrawlerå­é¡¹ç›®

ä¿®æ”¹åçš„ `db_config.py` ä½¿ç”¨ `os.getenv()`ï¼š

```python
import os

# MySQLé…ç½®
MYSQL_DB_PWD = os.getenv("DB_PASSWORD", "bettafish_2024")
MYSQL_DB_USER = os.getenv("DB_USER", "bettafish")
MYSQL_DB_HOST = os.getenv("DB_HOST", "localhost")
MYSQL_DB_PORT = int(os.getenv("DB_PORT", "5432"))
MYSQL_DB_NAME = os.getenv("DB_NAME", "bettafish")

# PostgreSQLé…ç½®
POSTGRESQL_DB_PWD = os.getenv("DB_PASSWORD", "bettafish_2024")
POSTGRESQL_DB_USER = os.getenv("DB_USER", "bettafish")
POSTGRESQL_DB_HOST = os.getenv("DB_HOST", "localhost")
POSTGRESQL_DB_PORT = os.getenv("DB_PORT", "5432")
POSTGRESQL_DB_NAME = os.getenv("DB_NAME", "bettafish")
```

## ğŸ¯ ä¼˜åŠ¿

### 1. å•ä¸€é…ç½®æº
- âœ… åªéœ€ä¿®æ”¹ `.env` æ–‡ä»¶
- âœ… æ— éœ€åŒæ­¥å¤šä¸ªé…ç½®æ–‡ä»¶
- âœ… é¿å…é…ç½®ä¸ä¸€è‡´

### 2. ç¬¦åˆæœ€ä½³å®è·µ
- âœ… éµå¾ª12-Factor AppåŸåˆ™
- âœ… ç¯å¢ƒå˜é‡ç®¡ç†é…ç½®
- âœ… æ•æ„Ÿä¿¡æ¯ä¸å…¥åº“

### 3. ç®€åŒ–ä»£ç 
- âœ… åˆ é™¤äº†90å¤šè¡Œçš„ä¸´æ—¶æ¡¥æ¥ä»£ç 
- âœ… `configure_mediacrawler_db()` ä»100è¡Œç®€åŒ–åˆ°15è¡Œ
- âœ… æ›´æ˜“ç»´æŠ¤

## ğŸ“ ä½¿ç”¨è¯´æ˜

### ä¿®æ”¹æ•°æ®åº“é…ç½®

åªéœ€ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š

```bash
# åˆ‡æ¢åˆ°MySQL
DB_DIALECT=mysql
DB_PORT=3306

# åˆ‡æ¢åˆ°PostgreSQL
DB_DIALECT=postgresql
DB_PORT=5432
```

### ç¯å¢ƒå˜é‡åŠ è½½

ç¡®ä¿åœ¨è¿è¡Œå‰åŠ è½½ `.env` æ–‡ä»¶ï¼š

```python
# æ–¹å¼1ï¼šä½¿ç”¨python-dotenvï¼ˆæ¨èï¼‰
from dotenv import load_dotenv
load_dotenv()

# æ–¹å¼2ï¼šä½¿ç”¨pydantic-settingsï¼ˆè‡ªåŠ¨åŠ è½½ï¼‰
from pydantic_settings import BaseSettings
```

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. ç¯å¢ƒå˜é‡ä¼˜å…ˆçº§

```
å®é™…ç¯å¢ƒå˜é‡ > .envæ–‡ä»¶ > ä»£ç é»˜è®¤å€¼
```

### 2. ç±»å‹è½¬æ¢

æ³¨æ„ç«¯å£å·éœ€è¦è½¬æ¢ä¸ºæ•´æ•°ï¼š

```python
MYSQL_DB_PORT = int(os.getenv("DB_PORT", "5432"))
```

### 3. é»˜è®¤å€¼

æ‰€æœ‰é…ç½®éƒ½æä¾›äº†åˆç†çš„é»˜è®¤å€¼ï¼Œç¡®ä¿åœ¨ `.env` ç¼ºå¤±æ—¶ä¹Ÿèƒ½è¿è¡Œã€‚

## ğŸ”§ ç›¸å…³æ–‡ä»¶

### ä¸»è¦é…ç½®æ–‡ä»¶

1. **`.env`** - ç¯å¢ƒå˜é‡é…ç½®ï¼ˆä¸»é…ç½®æºï¼‰
2. **`config.py`** - BettaFishä¸»é¡¹ç›®é…ç½®ç®¡ç†
3. **`DeepSentimentCrawling/MediaCrawler/config/db_config.py`** - MediaCrawleræ•°æ®åº“é…ç½®

### ä¿®æ”¹çš„æ–‡ä»¶

- âœ… `db_config.py` - æ”¹ä¸ºä»ç¯å¢ƒå˜é‡è¯»å–
- âœ… `platform_crawler.py` - ç®€åŒ–é…ç½®åŒæ­¥é€»è¾‘

## ğŸ“š å‚è€ƒ

- [The Twelve-Factor App - Config](https://12factor.net/config)
- [Pydantic Settings Documentation](https://docs.pydantic.dev/latest/concepts/pydantic_settings/)
- [python-dotenv Documentation](https://github.com/theskumar/python-dotenv)
