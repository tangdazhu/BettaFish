# Rerun åŠŸèƒ½å®ç°æ€»ç»“

> BettaFish é¡¹ç›® - ä¸‰å¤§ Engine åœæ­¢ä¸é‡æ–°è¿è¡ŒåŠŸèƒ½æŠ€æœ¯æ–‡æ¡£  
> **ç‰ˆæœ¬**: 3.0  
> **æœ€åæ›´æ–°**: 2025-11-12 22:42  
> **ä½œè€…**: BettaFish Team

---

## ğŸ“‹ ç›®å½•

1. [é—®é¢˜èƒŒæ™¯](#é—®é¢˜èƒŒæ™¯)
2. [æ ¸å¿ƒé—®é¢˜](#æ ¸å¿ƒé—®é¢˜)
3. [æœ€ç»ˆè§£å†³æ–¹æ¡ˆ](#æœ€ç»ˆè§£å†³æ–¹æ¡ˆ)
4. [æŠ€æœ¯å®ç°](#æŠ€æœ¯å®ç°)
5. [ä½¿ç”¨æŒ‡å—](#ä½¿ç”¨æŒ‡å—)
6. [åœæ­¢å“åº”æ—¶é—´è¯¦ç»†åˆ†æ](#åœæ­¢å“åº”æ—¶é—´è¯¦ç»†åˆ†æ)
7. [æ³¨æ„äº‹é¡¹](#æ³¨æ„äº‹é¡¹)
8. [æ€»ç»“](#æ€»ç»“)

---

## ğŸ” é—®é¢˜èƒŒæ™¯

### ç”¨æˆ·åé¦ˆ

ç”¨æˆ·åœ¨ä½¿ç”¨ä¸‰å¤§ Engine æ—¶å‘ç°ï¼š

**MediaEngine å’Œ QueryEngine**ï¼š
- âŒ **åœæ­¢åå¡ä½**ï¼šç‚¹å‡»"åœæ­¢"åä¸€ç›´æ˜¾ç¤º"â¹ï¸ æ­£åœ¨åœæ­¢ä»»åŠ¡ï¼Œè¯·ç¨å€™..."
- âŒ **é‡æ–°è¿è¡ŒæŒ‰é’®ä¸å‡ºç°**ï¼šä»»åŠ¡åœæ­¢åï¼Œ"ğŸ”„ é‡æ–°è¿è¡Œ"æŒ‰é’®æ²¡æœ‰æ˜¾ç¤º
- âŒ **å¿…é¡»åˆ·æ–°é¡µé¢**ï¼šåªèƒ½é€šè¿‡åˆ·æ–°æ•´ä¸ªé¡µé¢æ‰èƒ½ç»§ç»­æ“ä½œ

**InsightEngine**ï¼š
- âš ï¸ **åœæ­¢å“åº”æ…¢**ï¼šåœ¨ LLM è°ƒç”¨æœŸé—´ç‚¹å‡»åœæ­¢ï¼Œéœ€è¦ç­‰å¾… LLM å®Œæˆï¼ˆ1-3åˆ†é’Ÿï¼‰
- âœ… **æœ€ç»ˆå¯ç”¨**ï¼šç­‰å¾… LLM å®Œæˆåï¼Œèƒ½æ­£ç¡®æ˜¾ç¤º"ğŸ”„ é‡æ–°è¿è¡Œ"æŒ‰é’®

### å½±å“èŒƒå›´

| Engine | åœæ­¢åŠŸèƒ½ | é‡æ–°è¿è¡ŒæŒ‰é’® | çŠ¶æ€ |
|--------|---------|-------------|------|
| **Query Engine** | âš ï¸ è®¾ç½®ä¿¡å·æˆåŠŸ | âŒ ä¸æ˜¾ç¤º | å·²ä¿®å¤ âœ… |
| **Media Engine** | âš ï¸ è®¾ç½®ä¿¡å·æˆåŠŸ | âŒ ä¸æ˜¾ç¤º | å·²ä¿®å¤ âœ… |
| **Insight Engine** | â³ å“åº”æ…¢ï¼ˆLLMï¼‰ | âœ… æ­£å¸¸æ˜¾ç¤º | æ­£å¸¸ âœ… |

---

## ğŸ”¬ æ ¸å¿ƒé—®é¢˜

### é—®é¢˜1: MediaEngine å’Œ QueryEngine æ¶æ„ç¼ºé™·

**ä½¿ç”¨æ—§çš„ `while` å¾ªç¯ç›‘æ§æ¨¡å¼ï¼Œé”™è¯¯æ£€æŸ¥åœ¨å¾ªç¯å†…éƒ¨**ï¼š

```python
# âŒ é”™è¯¯çš„ç›‘æ§å¾ªç¯ç»“æ„ï¼ˆæ—§æ¶æ„ï¼‰
def execute_research(query: str, config: Settings):
    # ... å¯åŠ¨åå°çº¿ç¨‹ ...
    
    # è½®è¯¢ä»»åŠ¡çŠ¶æ€ï¼ˆåœ¨ execute_research å‡½æ•°å†…éƒ¨ï¼‰
    while result_container['is_running']:
        # ... æ£€æŸ¥ä»»åŠ¡çŠ¶æ€ ...
        
        # æ£€æŸ¥æ˜¯å¦æœ‰é”™è¯¯ï¼ˆåœ¨å¾ªç¯å†…éƒ¨ï¼‰
        if result_container['task_error']:  # â† è¿™æ®µä»£ç æ°¸è¿œä¸ä¼šæ‰§è¡Œï¼
            st.session_state.task_error = result_container['task_error']
            st.warning("âœ‹ ä»»åŠ¡å·²è¢«ç”¨æˆ·åœæ­¢")
            st.session_state.is_running = False
            time.sleep(0.5)
            st.rerun()  # â† æ°¸è¿œä¸ä¼šæ‰§è¡Œåˆ°è¿™é‡Œï¼
            break
        
        time.sleep(0.5)
        st.rerun()  # â† åˆ·æ–°åï¼Œexecute_research ä¸ä¼šå†è¢«è°ƒç”¨ï¼
```

**é—®é¢˜åˆ†æ**ï¼š
1. ç”¨æˆ·ç‚¹å‡»"åœæ­¢"æŒ‰é’® â†’ è®¾ç½® `stop_event`
2. åå°çº¿ç¨‹æ£€æµ‹åˆ°åœæ­¢ä¿¡å· â†’ è®¾ç½® `result_container['is_running'] = False` å’Œ `task_error = "ç”¨æˆ·è¯·æ±‚åœæ­¢"`
3. ç›‘æ§å¾ªç¯æ£€æµ‹åˆ° `is_running = False` â†’ **ç«‹å³é€€å‡º `while` å¾ªç¯**
4. é”™è¯¯æ£€æŸ¥ä»£ç åœ¨å¾ªç¯å†…éƒ¨ â†’ **æ°¸è¿œä¸ä¼šè¢«æ‰§è¡Œ**
5. `st.rerun()` åˆ·æ–°é¡µé¢ â†’ `execute_research` ä¸ä¼šå†è¢«è°ƒç”¨ï¼ˆå› ä¸º `start_research = False`ï¼‰
6. ç›‘æ§å¾ªç¯è¢«ä¸­æ–­ â†’ é¡µé¢ä¸åˆ·æ–° â†’ æŒ‰é’®çŠ¶æ€ä¸æ›´æ–° â†’ ç”¨æˆ·çœ‹åˆ°"æ­£åœ¨åœæ­¢ä»»åŠ¡"å¡ä½

### é—®é¢˜2: InsightEngine åœæ­¢å“åº”æ…¢

**InsightEngine æ¶æ„æ­£ç¡®ï¼Œä½†åœ¨ LLM è°ƒç”¨æœŸé—´åœæ­¢å“åº”æ…¢**ï¼š
- InsightEngine å·²ç»ä½¿ç”¨æ–°æ¶æ„ï¼ˆç›‘æ§é€»è¾‘åœ¨ `main()` å‡½æ•°ä¸­ï¼‰
- é”™è¯¯æ£€æŸ¥ä»£ç åœ¨å¾ªç¯å¤–éƒ¨ï¼Œèƒ½æ­£å¸¸æ‰§è¡Œ
- **ä½†æ˜¯**ï¼šåœ¨ LLM è°ƒç”¨æœŸé—´ï¼ˆç‰¹åˆ«æ˜¯ Kimi-k2-thinking æ€è€ƒå‹æ¨¡å‹ï¼‰ï¼Œéœ€è¦ç­‰å¾… LLM å®Œæˆï¼ˆ1-3åˆ†é’Ÿï¼‰æ‰èƒ½æ£€æµ‹åˆ°åœæ­¢ä¿¡å·
- è¿™æ˜¯ LLM API é˜»å¡è°ƒç”¨çš„æŠ€æœ¯é™åˆ¶

---

## ğŸ’¡ æœ€ç»ˆè§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ1: æ¶æ„é‡æ„ï¼ˆMediaEngine & QueryEngineï¼‰

**å°†ç›‘æ§é€»è¾‘ä» `execute_research` ç§»åˆ° `main()` å‡½æ•°ï¼Œå‚è€ƒ InsightEngine çš„å®ç°**ï¼š

#### æ­¥éª¤1: åˆ›å»º `start_research_thread()` å‡½æ•°

```python
def start_research_thread(query: str, config: Settings):
    """å¯åŠ¨ç ”ç©¶çº¿ç¨‹"""  
    # é‡ç½®åœæ­¢äº‹ä»¶å’ŒçŠ¶æ€
    st.session_state.stop_event.clear()
    st.session_state.is_running = True
    st.session_state.task_result = {"status": "å¯åŠ¨ä¸­", "progress": 0}
    st.session_state.task_error = None
    
    # åˆ›å»ºç»“æœå®¹å™¨ï¼ˆç”¨äºçº¿ç¨‹é—´é€šä¿¡ï¼‰
    result_container = {
        'agent': None,
        'task_result': None,
        'task_error': None,
        'is_running': True
    }
    st.session_state.result_container = result_container
    
    # å¯åŠ¨åå°çº¿ç¨‹
    task_thread = threading.Thread(
        target=_run_research_in_thread,
        args=(query, config, st.session_state.stop_event, result_container),
        daemon=True
    )
    task_thread.start()
    st.session_state.task_thread = task_thread
    logger.info("åå°ç ”ç©¶çº¿ç¨‹å·²å¯åŠ¨")
    
    # åˆ·æ–°é¡µé¢ä»¥å¯åŠ¨ç›‘æ§
    st.rerun()
```

#### æ­¥éª¤2: åˆ›å»º `monitor_research_progress()` å‡½æ•°

```python
def monitor_research_progress():
    """ç›‘æ§ç ”ç©¶è¿›åº¦ï¼ˆæ¯æ¬¡ st.rerun() åéƒ½ä¼šæ‰§è¡Œï¼‰"""
    if 'result_container' not in st.session_state:
        return
    
    result_container = st.session_state.result_container
    
    # åˆ›å»ºè¿›åº¦æ¡å’ŒçŠ¶æ€æ˜¾ç¤º
    progress_bar = st.progress(0)
    status_text = st.empty()
    
    # âœ… å…³é”®ä¿®å¤ï¼šå…ˆæ£€æŸ¥æ˜¯å¦æœ‰é”™è¯¯ï¼ˆæ— è®ºä»»åŠ¡æ˜¯å¦è¿˜åœ¨è¿è¡Œï¼‰
    if result_container.get('task_error'):
        st.session_state.task_error = result_container['task_error']
        if result_container['task_error'] == "ç”¨æˆ·è¯·æ±‚åœæ­¢":
            st.warning("âœ‹ ä»»åŠ¡å·²è¢«ç”¨æˆ·åœæ­¢")
            logger.info("ä»»åŠ¡è¢«ç”¨æˆ·åœæ­¢")
        else:
            st.error(f"ç ”ç©¶è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯: {result_container['task_error']}")
        st.session_state.is_running = False
        # åˆ·æ–°é¡µé¢ä»¥æ˜¾ç¤ºé‡æ–°è¿è¡ŒæŒ‰é’®
        time.sleep(0.5)
        st.rerun()
        return
    
    # æ£€æŸ¥ä»»åŠ¡çŠ¶æ€
    if result_container['is_running']:
        # ... æ›´æ–°è¿›åº¦ ...
        time.sleep(0.5)
        st.rerun()
    else:
        # ä»»åŠ¡å·²ç»“æŸ
        st.session_state.is_running = False
```

#### æ­¥éª¤3: åœ¨ `main()` å‡½æ•°ä¸­è°ƒç”¨ç›‘æ§

```python
def main():
    # ... åˆå§‹åŒ–å’Œé…ç½® ...
    
    if start_research:
        # å¯åŠ¨ç ”ç©¶çº¿ç¨‹
        start_research_thread(query, config)
    
    # âœ… å…³é”®ï¼šæ¯æ¬¡ st.rerun() åéƒ½ä¼šæ‰§è¡Œç›‘æ§
    if st.session_state.is_running:
        monitor_research_progress()
```

### ä¸ºä»€ä¹ˆæ¶æ„é‡æ„æœ‰æ•ˆ

**æ–°æ¶æ„çš„æ‰§è¡Œæµç¨‹**ï¼š
1. ç”¨æˆ·ç‚¹å‡»"åœæ­¢"æŒ‰é’® â†’ è®¾ç½® `stop_event`
2. åå°çº¿ç¨‹æ£€æµ‹åˆ°åœæ­¢ä¿¡å· â†’ è®¾ç½® `result_container['is_running'] = False` å’Œ `task_error = "ç”¨æˆ·è¯·æ±‚åœæ­¢"`
3. `st.rerun()` åˆ·æ–°é¡µé¢ â†’ `main()` å‡½æ•°é‡æ–°æ‰§è¡Œ
4. `main()` è°ƒç”¨ `monitor_research_progress()` â†’ **æ¯æ¬¡åˆ·æ–°éƒ½ä¼šæ‰§è¡Œ** âœ…
5. `monitor_research_progress()` ä¼˜å…ˆæ£€æŸ¥ `task_error` â†’ æ£€æµ‹åˆ°é”™è¯¯ âœ…
6. æ˜¾ç¤ºè­¦å‘Šä¿¡æ¯ â†’ è°ƒç”¨ `st.rerun()` â†’ åˆ·æ–°é¡µé¢
7. é¡µé¢åˆ·æ–°å â†’ æŒ‰é’®çŠ¶æ€æ›´æ–° â†’ æ˜¾ç¤º"ğŸ”„ é‡æ–°è¿è¡Œ"æŒ‰é’® âœ…

**å…³é”®ä¼˜åŠ¿**ï¼š
- ç›‘æ§é€»è¾‘åœ¨ `main()` å‡½æ•°ä¸­ï¼Œæ¯æ¬¡ `st.rerun()` åéƒ½ä¼šæ‰§è¡Œ
- ä¸ä¼šè¢«ä¸­æ–­ï¼ŒæŒç»­ç›‘æ§åå°çº¿ç¨‹çŠ¶æ€
- é”™è¯¯æ£€æŸ¥ä¼˜å…ˆæ‰§è¡Œï¼Œç¡®ä¿åŠæ—¶å“åº”

---

## ğŸ› ï¸ æŠ€æœ¯å®ç°

### ä¿®æ”¹çš„æ–‡ä»¶

| æ–‡ä»¶ | è·¯å¾„ | ä¿®æ”¹å†…å®¹ |
|------|------|----------|
| **Media Engine** | `SingleEngineApp/media_engine_streamlit_app.py` | æ¶æ„é‡æ„ï¼šåˆ›å»º `start_research_thread()` å’Œ `monitor_research_progress()` |
| **Query Engine** | `SingleEngineApp/query_engine_streamlit_app.py` | æ¶æ„é‡æ„ï¼šåˆ›å»º `start_research_thread()` å’Œ `monitor_research_progress()` |
| **Insight Engine** | `SingleEngineApp/insight_engine_streamlit_app.py` | å·²æ­£ç¡®å®ç°ï¼ˆå‚è€ƒå®ç°ï¼‰ |

### å…³é”®ä»£ç ä½ç½®

#### MediaEngine (media_engine_streamlit_app.py)

**ä¿®æ”¹å‰**ï¼š
```python
# Line 263-341: execute_research() å‡½æ•°ï¼ˆæ—§æ¶æ„ï¼‰
def execute_research(query: str, config: Settings):
    # å¯åŠ¨åå°çº¿ç¨‹
    task_thread = threading.Thread(...)
    task_thread.start()
    
    # è½®è¯¢ä»»åŠ¡çŠ¶æ€ï¼ˆåœ¨å‡½æ•°å†…éƒ¨ï¼‰
    while result_container['is_running']:
        # ... æ£€æŸ¥ä»»åŠ¡çŠ¶æ€ ...
        st.rerun()  # â† åˆ·æ–°åï¼Œexecute_research ä¸ä¼šå†è¢«è°ƒç”¨
```

**ä¿®æ”¹å**ï¼š
```python
# Line 263-291: start_research_thread() - å¯åŠ¨çº¿ç¨‹
def start_research_thread(query: str, config: Settings):
    # å¯åŠ¨åå°çº¿ç¨‹
    task_thread = threading.Thread(...)
    task_thread.start()
    st.rerun()  # åˆ·æ–°ä»¥å¯åŠ¨ç›‘æ§

# Line 294-355: monitor_research_progress() - ç›‘æ§è¿›åº¦ï¼ˆæ¯æ¬¡åˆ·æ–°éƒ½æ‰§è¡Œï¼‰
def monitor_research_progress():
    # ä¼˜å…ˆæ£€æŸ¥é”™è¯¯
    if result_container.get('task_error'):
        # ... é”™è¯¯å¤„ç† ...
        st.rerun()
        return
    
    # æ£€æŸ¥ä»»åŠ¡çŠ¶æ€
    if result_container['is_running']:
        # ... æ›´æ–°è¿›åº¦ ...
        st.rerun()

# Line 173-177: main() å‡½æ•°ä¸­è°ƒç”¨ç›‘æ§
if start_research:
    start_research_thread(query, config)

if st.session_state.is_running:
    monitor_research_progress()  # â† æ¯æ¬¡åˆ·æ–°éƒ½ä¼šæ‰§è¡Œ
```

#### QueryEngine (query_engine_streamlit_app.py)

**ä¿®æ”¹å‰**ï¼š
```python
# Line 256-334: execute_research() å‡½æ•°ï¼ˆæ—§æ¶æ„ï¼‰
def execute_research(query: str, config: Settings):
    # å¯åŠ¨åå°çº¿ç¨‹
    task_thread = threading.Thread(...)
    task_thread.start()
    
    # è½®è¯¢ä»»åŠ¡çŠ¶æ€ï¼ˆåœ¨å‡½æ•°å†…éƒ¨ï¼‰
    while result_container['is_running']:
        # ... æ£€æŸ¥ä»»åŠ¡çŠ¶æ€ ...
        st.rerun()  # â† åˆ·æ–°åï¼Œexecute_research ä¸ä¼šå†è¢«è°ƒç”¨
```

**ä¿®æ”¹å**ï¼š
```python
# Line 260-288: start_research_thread() - å¯åŠ¨çº¿ç¨‹
def start_research_thread(query: str, config: Settings):
    # å¯åŠ¨åå°çº¿ç¨‹
    task_thread = threading.Thread(...)
    task_thread.start()
    st.rerun()  # åˆ·æ–°ä»¥å¯åŠ¨ç›‘æ§

# Line 291-352: monitor_research_progress() - ç›‘æ§è¿›åº¦ï¼ˆæ¯æ¬¡åˆ·æ–°éƒ½æ‰§è¡Œï¼‰
def monitor_research_progress():
    # ä¼˜å…ˆæ£€æŸ¥é”™è¯¯
    if result_container.get('task_error'):
        # ... é”™è¯¯å¤„ç† ...
        st.rerun()
        return
    
    # æ£€æŸ¥ä»»åŠ¡çŠ¶æ€
    if result_container['is_running']:
        # ... æ›´æ–°è¿›åº¦ ...
        st.rerun()

# Line 169-173: main() å‡½æ•°ä¸­è°ƒç”¨ç›‘æ§
if start_research:
    start_research_thread(query, config)

if st.session_state.is_running:
    monitor_research_progress()  # â† æ¯æ¬¡åˆ·æ–°éƒ½ä¼šæ‰§è¡Œ
```

#### InsightEngine (insight_engine_streamlit_app.py)

```python
# Line 283-314: ç›‘æ§å¾ªç¯
while result_container['is_running']:
    # ... ä»»åŠ¡çŠ¶æ€æ£€æŸ¥ ...
    time.sleep(0.5)
    st.rerun()

# Line 316-333: é”™è¯¯æ£€æŸ¥ï¼ˆå¾ªç¯å¤–éƒ¨ï¼‰âœ…
if result_container.get('task_error'):
    st.session_state.task_error = result_container['task_error']
    # ... é”™è¯¯å¤„ç† ...
    st.rerun()
```

#### InsightEngine (insight_engine_streamlit_app.py)

```python
# Line 332-351: é”™è¯¯æ£€æŸ¥ï¼ˆä¼˜å…ˆæ£€æŸ¥ï¼Œåœ¨å¾ªç¯å¤–ï¼‰âœ…
if result_container.get('task_error'):
    st.session_state.task_error = result_container['task_error']
    # ... é”™è¯¯å¤„ç† ...
    st.rerun()
    return

# Line 354-381: ç›‘æ§é€»è¾‘ï¼ˆå•æ¬¡æ£€æŸ¥æ¨¡å¼ï¼‰
if result_container['is_running']:
    # ... ä»»åŠ¡çŠ¶æ€æ£€æŸ¥ ...
    st.rerun()
else:
    # ä»»åŠ¡å·²ç»“æŸ
    st.session_state.is_running = False
```

---

## ğŸ“– ä½¿ç”¨æŒ‡å—

### ç”¨æˆ·æ“ä½œæµç¨‹

#### 1. å¯åŠ¨æœç´¢

1. åœ¨ä¸»é¡µé¢è¾“å…¥æŸ¥è¯¢å†…å®¹
2. ç‚¹å‡»"å¼€å§‹"æŒ‰é’®
3. ç³»ç»Ÿè‡ªåŠ¨è·³è½¬åˆ°å¯¹åº”çš„ Engine é¡µé¢
4. ä»»åŠ¡å¼€å§‹æ‰§è¡Œ

**ç•Œé¢çŠ¶æ€**ï¼š
- æ˜¾ç¤º "â¹ï¸ åœæ­¢" æŒ‰é’®ï¼ˆå¯ç‚¹å‡»ï¼‰
- æ˜¾ç¤ºè¿›åº¦æ¡å’ŒçŠ¶æ€æ–‡æœ¬
- æ§åˆ¶å°è¾“å‡ºå®æ—¶æ—¥å¿—

---

#### 2. åœæ­¢ä»»åŠ¡

1. ç‚¹å‡» "â¹ï¸ åœæ­¢" æŒ‰é’®
2. ç³»ç»Ÿæ˜¾ç¤º "â¹ï¸ æ­£åœ¨åœæ­¢ä»»åŠ¡ï¼Œè¯·ç¨å€™..."
3. åå°çº¿ç¨‹æ£€æµ‹åˆ°åœæ­¢ä¿¡å·
4. ä»»åŠ¡è¢«ä¸­æ­¢

**ç•Œé¢çŠ¶æ€**ï¼š
- æ˜¾ç¤º "âœ‹ ä»»åŠ¡å·²è¢«ç”¨æˆ·åœæ­¢"
- æŒ‰é’®è‡ªåŠ¨åˆ‡æ¢ä¸º "ğŸ”„ é‡æ–°è¿è¡Œ"ï¼ˆå¯ç‚¹å‡»ï¼‰

**åœæ­¢å“åº”æ—¶é—´**ï¼š

| Engine | æœ€å¿«å“åº” | æœ€æ…¢å“åº” | å¹³å‡å“åº” | å–å†³äº |
|--------|---------|---------|---------|--------|
| **MediaEngine** | ~1ç§’ | ~60ç§’ | ~10ç§’ | å½“å‰æ“ä½œç±»å‹ + LLMæ¨¡å‹ï¼ˆQwen-VL-Plusï¼‰ |
| **QueryEngine** | ~1ç§’ | ~60ç§’ | ~20ç§’ | å½“å‰æ“ä½œç±»å‹ + LLMæ¨¡å‹ï¼ˆQwen-Plusï¼‰ |
| **InsightEngine** | ~1ç§’ | ~180ç§’ | ~60ç§’ | å½“å‰æ“ä½œç±»å‹ + LLMæ¨¡å‹ï¼ˆKimi-k2-thinkingï¼‰ |

**å“åº”æ—¶é—´å–å†³äº**ï¼š
1. **å½“å‰æ“ä½œç±»å‹**ï¼š
   - ç½‘ç»œæœç´¢ï¼š1-5ç§’ âš¡
   - æ•°æ®åº“æŸ¥è¯¢ï¼š1-5ç§’ âš¡
   - LLM è°ƒç”¨ï¼š10ç§’-3åˆ†é’Ÿ â³ï¼ˆé˜»å¡æ“ä½œï¼‰

2. **ä½¿ç”¨çš„ LLM æ¨¡å‹**ï¼š
   - **Qwen-VL-Plus** (MediaEngine): é€šå¸¸ 10-30ç§’
   - **Qwen-Plus** (QueryEngine): é€šå¸¸ 20-40ç§’
   - **Kimi-k2-thinking** (InsightEngine): é€šå¸¸ 40-120ç§’ï¼ˆæ€è€ƒå‹æ¨¡å‹æ›´æ…¢ï¼‰

3. **åœæ­¢æ—¶æœº**ï¼ˆå®æµ‹æ•°æ®ï¼‰ï¼š
   - åœ¨æœç´¢é˜¶æ®µåœæ­¢ï¼š1-5ç§’ âœ…ï¼ˆMediaEngine å®æµ‹1ç§’ï¼‰
   - åœ¨ LLM è°ƒç”¨ä¸­åœæ­¢ï¼šéœ€è¦ç­‰å¾… LLM å®Œæˆ â³
     - QueryEngine å®æµ‹ï¼š34ç§’ï¼ˆQwen-Plus ç”Ÿæˆæ€»ç»“ï¼‰
     - InsightEngine å®æµ‹ï¼š59ç§’ï¼ˆKimi-k2-thinking ç”ŸæˆæŠ¥å‘Šç»“æ„ï¼‰

---

#### 3. é‡æ–°è¿è¡Œ

1. ç‚¹å‡» "ğŸ”„ é‡æ–°è¿è¡Œ" æŒ‰é’®
2. ç³»ç»Ÿé‡ç½®æ‰€æœ‰çŠ¶æ€
3. é¡µé¢è‡ªåŠ¨åˆ·æ–°
4. ä»»åŠ¡é‡æ–°å¼€å§‹æ‰§è¡Œ

**ç•Œé¢çŠ¶æ€**ï¼š
- æŒ‰é’®åˆ‡æ¢å› "â¹ï¸ åœæ­¢"
- æ§åˆ¶å°æ¸…ç©ºå¹¶æ˜¾ç¤ºæ–°çš„æ—¥å¿—
- è¿›åº¦æ¡é‡æ–°å¼€å§‹

**çŠ¶æ€é‡ç½®é€»è¾‘**ï¼š
```python
if st.button("ğŸ”„ é‡æ–°è¿è¡Œ", type="primary", ...):
    # é‡ç½®æ‰€æœ‰çŠ¶æ€
    st.session_state.task_result = None
    st.session_state.task_error = None
    st.session_state.stop_event = threading.Event()
    if 'auto_search_executed' in st.session_state:
        del st.session_state.auto_search_executed
    st.rerun()
```

---

#### 4. ä»»åŠ¡å®Œæˆ

1. ä»»åŠ¡è‡ªç„¶å®Œæˆï¼ˆæœªè¢«åœæ­¢ï¼‰
2. æ˜¾ç¤ºç ”ç©¶ç»“æœ
3. æŒ‰é’®è‡ªåŠ¨åˆ‡æ¢ä¸º "ğŸ”„ é‡æ–°è¿è¡Œ"

**ç•Œé¢çŠ¶æ€**ï¼š
- æ˜¾ç¤ºå®Œæ•´çš„ç ”ç©¶æŠ¥å‘Š
- å¯ä»¥ç‚¹å‡» "ğŸ”„ é‡æ–°è¿è¡Œ" é‡æ–°åˆ†æ

---

## ğŸ“Š åœæ­¢å“åº”æ—¶é—´è¯¦ç»†åˆ†æ

### å®æµ‹æ•°æ®å¯¹æ¯”

**æµ‹è¯•åœºæ™¯**ï¼šåŒæ—¶å¯åŠ¨ä¸‰ä¸ªå¼•æ“ï¼ŒæŸ¥è¯¢"AI Agentåœ¨è‡ªåŠ¨åŒ–æµç¨‹èƒ½åŠ›ä¸Šçš„æœ€æ–°è¿›å±•"ï¼Œåœ¨ä¸åŒé˜¶æ®µç‚¹å‡»åœæ­¢

| æµ‹è¯• | Engine | ç‚¹å‡»åœæ­¢æ—¶é—´ | å½“å‰æ“ä½œ | æ£€æµ‹åˆ°åœæ­¢æ—¶é—´ | å“åº”æ—¶é—´ | è¯´æ˜ |
|------|--------|------------|---------|--------------|---------|------|
| 1 | MediaEngine | 22:38:47 | åæ€æœç´¢ | 22:38:48 | **~1ç§’** | æœç´¢å®Œæˆåç«‹å³è¿›å…¥ LLM è°ƒç”¨å‰æ£€æŸ¥ âœ… |
| 2 | QueryEngine | 22:38:49 | LLM æ€»ç»“ | 22:39:23 | **~34ç§’** | åœ¨ Qwen-Plus è°ƒç”¨ä¸­ï¼Œç­‰å¾…å®Œæˆ â³ |
| 3 | InsightEngine | 22:38:45 | LLM æŠ¥å‘Šç»“æ„ | 22:39:44 | **~59ç§’** | åœ¨ Kimi-k2-thinking è°ƒç”¨ä¸­ï¼Œç­‰å¾…å®Œæˆ â³ |

### ä¸ºä»€ä¹ˆå“åº”æ—¶é—´å·®å¼‚è¿™ä¹ˆå¤§ï¼Ÿ

#### MediaEngine - æœ€å¿«ï¼ˆ~1ç§’ï¼‰

**æ—¶é—´çº¿**ï¼š
```
22:38:47.800 - æ‰§è¡Œæœç´¢å·¥å…·: comprehensive_search
22:38:47.923 - ç”¨æˆ·ç‚¹å‡»åœæ­¢ â† åœ¨æœç´¢ä¸­
22:38:48.321 - æœªæ‰¾åˆ°åæ€æœç´¢ç»“æœï¼ˆæœç´¢å®Œæˆï¼‰
22:38:48.321 - æ­£åœ¨ç”Ÿæˆåæ€æ€»ç»“
22:38:48.321 - æ£€æŸ¥åœæ­¢äº‹ä»¶çŠ¶æ€: True âœ…ï¼ˆLLM è°ƒç”¨å‰ï¼‰
22:38:48.321 - æ£€æµ‹åˆ°åœæ­¢ä¿¡å·ï¼Œä¸­æ­¢é‡è¯•
```

**å…³é”®ç‚¹**ï¼š
- æœç´¢æ˜¯å¿«é€Ÿæ“ä½œï¼ˆ~500msï¼‰
- æœç´¢å®Œæˆåï¼Œ**ç«‹å³**è¿›å…¥ LLM è°ƒç”¨å‰çš„åœæ­¢æ£€æŸ¥
- åœ¨ LLM è°ƒç”¨å‰å°±æ£€æµ‹åˆ°åœæ­¢ä¿¡å·ï¼Œæ‰€ä»¥åªç”¨äº†1ç§’ âœ…

#### QueryEngine - ç¬¬äºŒå¿«ï¼ˆ~34ç§’ï¼‰

**æ—¶é—´çº¿**ï¼š
```
22:38:45.882 - æ­£åœ¨ç”Ÿæˆé¦–æ¬¡æ®µè½æ€»ç»“
22:38:45.882 - æ£€æŸ¥åœæ­¢äº‹ä»¶çŠ¶æ€: False
22:38:49.933 - ç”¨æˆ·ç‚¹å‡»åœæ­¢ â† åœ¨ LLM è°ƒç”¨ä¸­ï¼ˆQwen-Plusï¼‰
... ç­‰å¾… LLM å®Œæˆ ...
22:39:23.673 - æˆåŠŸç”Ÿæˆé¦–æ¬¡æ®µè½æ€»ç»“ï¼ˆLLM å®Œæˆï¼‰
22:39:23.673 - æ­£åœ¨è¿›è¡Œåæ€å¹¶ç”Ÿæˆæ–°æœç´¢æŸ¥è¯¢
22:39:23.673 - æ£€æŸ¥åœæ­¢äº‹ä»¶çŠ¶æ€: True âœ…ï¼ˆLLM è°ƒç”¨åï¼‰
```

**å…³é”®ç‚¹**ï¼š
- åœ¨ Qwen-Plus LLM è°ƒç”¨ä¸­ç‚¹å‡»åœæ­¢
- éœ€è¦ç­‰å¾… LLM å®Œæˆï¼ˆ34ç§’ï¼‰
- LLM å®Œæˆåï¼Œç«‹å³æ£€æµ‹åˆ°åœæ­¢ä¿¡å· âœ…

#### InsightEngine - æœ€æ…¢ï¼ˆ~59ç§’ï¼‰

**æ—¶é—´çº¿**ï¼š
```
22:38:31.650 - æ­£åœ¨ä¸ºæŸ¥è¯¢ç”ŸæˆæŠ¥å‘Šç»“æ„
22:38:31.650 - æ£€æŸ¥åœæ­¢äº‹ä»¶çŠ¶æ€: False
22:38:45.795 - ç”¨æˆ·ç‚¹å‡»åœæ­¢ â† åœ¨ LLM è°ƒç”¨ä¸­ï¼ˆKimi-k2-thinkingï¼‰
... ç­‰å¾… LLM å®Œæˆ ...
22:39:44.976 - æŠ¥å‘Šç»“æ„å·²ç”Ÿæˆï¼ˆLLM å®Œæˆï¼Œ59ç§’ï¼‰
22:39:44.976 - åœ¨ç”ŸæˆæŠ¥å‘Šç»“æ„åæ£€æµ‹åˆ°åœæ­¢ä¿¡å· âœ…
```

**å…³é”®ç‚¹**ï¼š
- åœ¨ Kimi-k2-thinking LLM è°ƒç”¨ä¸­ç‚¹å‡»åœæ­¢
- **æ€è€ƒå‹æ¨¡å‹**éœ€è¦æ›´é•¿æ—¶é—´ï¼ˆ59ç§’ï¼‰
- LLM å®Œæˆåï¼Œç«‹å³æ£€æµ‹åˆ°åœæ­¢ä¿¡å· âœ…

### ç»“è®º

**åœæ­¢å“åº”æ—¶é—´ = å½“å‰æ“ä½œå‰©ä½™æ—¶é—´ + æ£€æµ‹å»¶è¿Ÿï¼ˆ<1ç§’ï¼‰**

1. **åœ¨é LLM æ“ä½œä¸­åœæ­¢**ï¼š1-5ç§’ âš¡
   - ç½‘ç»œæœç´¢ã€æ•°æ®åº“æŸ¥è¯¢ç­‰å¿«é€Ÿæ“ä½œ
   - MediaEngine å®æµ‹1ç§’å°±æ˜¯è¿™ç§æƒ…å†µ

2. **åœ¨ LLM è°ƒç”¨ä¸­åœæ­¢**ï¼šéœ€è¦ç­‰å¾… LLM å®Œæˆ â³
   - Qwen-Plus: é€šå¸¸ 20-40ç§’
   - Qwen-VL-Plus: é€šå¸¸ 10-30ç§’
   - Kimi-k2-thinking: é€šå¸¸ 40-120ç§’ï¼ˆæ€è€ƒå‹æ¨¡å‹ï¼‰

3. **æ— æ³•æ”¹è¿›çš„æŠ€æœ¯é™åˆ¶**ï¼š
   - LLM API è°ƒç”¨æ˜¯**åŒæ­¥é˜»å¡æ“ä½œ**
   - ä¸€æ—¦å‘é€è¯·æ±‚ï¼ŒPython ä»£ç è¢«é˜»å¡
   - æ— æ³•åœ¨ç­‰å¾…å“åº”æœŸé—´æ‰§è¡Œåœæ­¢æ£€æµ‹ä»£ç 
   - åªèƒ½ç­‰å¾… LLM å®Œæˆåæ‰èƒ½æ£€æµ‹åœæ­¢ä¿¡å·

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. LLM è°ƒç”¨æœŸé—´åœæ­¢å“åº”æ…¢çš„åŸå› 

**æŠ€æœ¯é™åˆ¶**ï¼š
- LLM API è°ƒç”¨æ˜¯**é˜»å¡æ“ä½œ**
- åœ¨ç­‰å¾… API å“åº”æœŸé—´ï¼ŒPython ä»£ç ä¸ä¼šæ‰§è¡Œ
- åœæ­¢æ£€æµ‹ä»£ç æ— æ³•åœ¨ LLM è°ƒç”¨æœŸé—´è¿è¡Œ

**å½“å‰å®ç°**ï¼š
```python
# InsightEngine/llms/base.py
def invoke(self, system_prompt: str, user_prompt: str, **kwargs) -> str:
    @with_retry(LLM_RETRY_CONFIG, stop_event=self.stop_event)
    def _invoke_with_retry():
        if self.stop_event and self.stop_event.is_set():  # â† åªåœ¨è°ƒç”¨å‰æ£€æŸ¥
            raise InterruptedError("ç”¨æˆ·è¯·æ±‚åœæ­¢")
        return self._do_invoke(system_prompt, user_prompt, **kwargs)  # â† é˜»å¡è°ƒç”¨
    return _invoke_with_retry()
```

**åœæ­¢æ£€æµ‹ç‚¹**ï¼š
1. âœ… LLM è°ƒç”¨**å‰**ï¼šç«‹å³å“åº”ï¼ˆ<1ç§’ï¼‰
2. âŒ LLM è°ƒç”¨**ä¸­**ï¼šæ— æ³•æ£€æµ‹ï¼ˆé˜»å¡ï¼‰
3. âœ… LLM è°ƒç”¨**å**ï¼šç«‹å³å“åº”ï¼ˆ<1ç§’ï¼‰

**ç”¨æˆ·ä½“éªŒ**ï¼š
- å¦‚æœåœ¨ LLM è°ƒç”¨å¤–ç‚¹å‡»åœæ­¢ï¼š1-5 ç§’å“åº” âœ…
- å¦‚æœåœ¨ LLM è°ƒç”¨ä¸­ç‚¹å‡»åœæ­¢ï¼šéœ€è¦ç­‰å¾… LLM å®Œæˆï¼ˆ1-3 åˆ†é’Ÿï¼‰â³
- ç­‰å¾…æœŸé—´æ˜¾ç¤ºï¼š"â¹ï¸ æ­£åœ¨åœæ­¢ä»»åŠ¡ï¼Œè¯·ç¨å€™..."

**æœªæ¥ä¼˜åŒ–æ–¹å‘**ï¼š
1. ä½¿ç”¨å¼‚æ­¥ LLM è°ƒç”¨ï¼ˆéœ€è¦é‡æ„ï¼‰
2. æ·»åŠ è¶…æ—¶æœºåˆ¶ï¼ˆå¯èƒ½ä¸¢å¤±éƒ¨åˆ†å“åº”ï¼‰
3. ä½¿ç”¨å¯ä¸­æ–­çš„ HTTP å®¢æˆ·ç«¯ï¼ˆå¤æ‚åº¦é«˜ï¼‰

---

### 2. çŠ¶æ€åˆå§‹åŒ–

**å¿…é¡»åœ¨ä½¿ç”¨å‰åˆå§‹åŒ–æ‰€æœ‰ session_state å˜é‡**ï¼š

```python
# âœ… æ­£ç¡®ï¼šåœ¨ main() å‡½æ•°å¼€å§‹æ—¶åˆå§‹åŒ–
if 'stop_event' not in st.session_state:
    st.session_state.stop_event = threading.Event()

if 'is_running' not in st.session_state:
    st.session_state.is_running = False

if 'task_thread' not in st.session_state:
    st.session_state.task_thread = None

if 'task_result' not in st.session_state:
    st.session_state.task_result = None

if 'task_error' not in st.session_state:
    st.session_state.task_error = None
```

**å¸¸è§é”™è¯¯**ï¼š
```
AttributeError: st.session_state has no attribute "task_result". 
Did you forget to initialize it?
```

---

### 3. çº¿ç¨‹å®‰å…¨

**å½“å‰å®ç°**ï¼š
- é€šè¿‡ `stop_event.set()` é€šçŸ¥çº¿ç¨‹åœæ­¢
- çº¿ç¨‹æ£€æµ‹åˆ°ä¿¡å·åè‡ªè¡Œé€€å‡º
- é‡æ–°è¿è¡Œæ—¶åˆ›å»ºæ–°çš„ `stop_event`

**æ½œåœ¨é—®é¢˜**ï¼š
- å¦‚æœçº¿ç¨‹æ²¡æœ‰åŠæ—¶åœæ­¢ï¼Œå¯èƒ½ä¼šæœ‰ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶è¿è¡Œ
- å½“å‰é€šè¿‡ `is_running` æ ‡å¿—é˜²æ­¢è¿™ç§æƒ…å†µ

**å»ºè®®**ï¼š
- åœ¨é‡æ–°è¿è¡Œå‰ï¼Œç¡®ä¿ `st.session_state.is_running == False`
- å½“å‰å®ç°å·²ç»é€šè¿‡æŒ‰é’®çŠ¶æ€åˆ¤æ–­ä¿è¯äº†è¿™ä¸€ç‚¹

---

### 4. æŒ‰é’®çŠ¶æ€è®¾è®¡

**ä¸‰ç§çŠ¶æ€**ï¼š

```python
if st.session_state.is_running:
    # çŠ¶æ€1: ä»»åŠ¡è¿è¡Œä¸­ â†’ æ˜¾ç¤ºåœæ­¢æŒ‰é’®
    st.button("â¹ï¸ åœæ­¢", type="secondary", ...)

elif st.session_state.task_result or st.session_state.task_error:
    # çŠ¶æ€2: ä»»åŠ¡å·²å®Œæˆæˆ–å‡ºé”™ â†’ æ˜¾ç¤ºé‡æ–°è¿è¡ŒæŒ‰é’®
    st.button("ğŸ”„ é‡æ–°è¿è¡Œ", type="primary", ...)

else:
    # çŠ¶æ€3: åˆå§‹çŠ¶æ€ â†’ æ˜¾ç¤ºç¦ç”¨çš„åœæ­¢æŒ‰é’®
    st.button("â¹ï¸ åœæ­¢", type="secondary", disabled=True, ...)
```

**è®¾è®¡ç†ç”±**ï¼š
- **åœæ­¢æŒ‰é’®**ï¼šä½¿ç”¨ `secondary` æ ·å¼ï¼ˆç°è‰²ï¼‰ï¼Œä½è°ƒï¼Œé¿å…è¯¯æ“ä½œ
- **é‡æ–°è¿è¡ŒæŒ‰é’®**ï¼šä½¿ç”¨ `primary` æ ·å¼ï¼ˆè“è‰²ï¼‰ï¼Œé†’ç›®ï¼Œå¼•å¯¼ç”¨æˆ·æ“ä½œ
- **å›¾æ ‡é€‰æ‹©**ï¼š
  - â¹ï¸ åœæ­¢ï¼šæ–¹å½¢åœæ­¢ç¬¦å·
  - ğŸ”„ é‡æ–°è¿è¡Œï¼šå¾ªç¯ç®­å¤´ï¼Œè¡¨ç¤ºé‡æ–°å¼€å§‹

---

## ğŸ“Š ä¿®å¤å‰åå¯¹æ¯”

| ç‰¹æ€§ | ä¿®å¤å‰ | ä¿®å¤å |
|------|--------|--------|
| **MediaEngine åœæ­¢** | âŒ å¡åœ¨"æ­£åœ¨åœæ­¢" | âœ… æ­£å¸¸æ˜¾ç¤ºé‡æ–°è¿è¡ŒæŒ‰é’® |
| **QueryEngine åœæ­¢** | âŒ å¡åœ¨"æ­£åœ¨åœæ­¢" | âœ… æ­£å¸¸æ˜¾ç¤ºé‡æ–°è¿è¡ŒæŒ‰é’® |
| **InsightEngine åœæ­¢** | â³ å“åº”æ…¢ï¼ˆLLMï¼‰ | â³ å“åº”æ…¢ï¼ˆLLMï¼ŒæŠ€æœ¯é™åˆ¶ï¼‰ |
| **é‡æ–°è¿è¡ŒåŠŸèƒ½** | âœ… æ­£å¸¸å·¥ä½œ | âœ… æ­£å¸¸å·¥ä½œ |
| **ä¸‰å¼•æ“ä¸€è‡´æ€§** | âš ï¸ ä¸ä¸€è‡´ | âœ… å®Œå…¨ä¸€è‡´ |
| **ç”¨æˆ·ä½“éªŒ** | âŒ éœ€è¦åˆ·æ–°é¡µé¢ | âœ… è‡ªåŠ¨åˆ·æ–° |

---

## ğŸ¯ æ€»ç»“

### æ ¸å¿ƒä¿®å¤

**MediaEngine å’Œ QueryEngine çš„æ¶æ„é‡æ„**ï¼š

1. **åˆ›å»º `start_research_thread()` å‡½æ•°**ï¼š
   - å¯åŠ¨åå°çº¿ç¨‹
   - åˆå§‹åŒ–ç»“æœå®¹å™¨
   - è°ƒç”¨ `st.rerun()` å¯åŠ¨ç›‘æ§

2. **åˆ›å»º `monitor_research_progress()` å‡½æ•°**ï¼š
   - åœ¨ `main()` å‡½æ•°ä¸­è°ƒç”¨
   - æ¯æ¬¡ `st.rerun()` åéƒ½ä¼šæ‰§è¡Œ
   - ä¼˜å…ˆæ£€æŸ¥ `task_error`
   - æŒç»­ç›‘æ§åå°çº¿ç¨‹çŠ¶æ€

3. **åœ¨ `main()` å‡½æ•°ä¸­è°ƒç”¨ç›‘æ§**ï¼š
   - `if st.session_state.is_running: monitor_research_progress()`
   - ç¡®ä¿ç›‘æ§é€»è¾‘ä¸ä¼šè¢«ä¸­æ–­

**å½±å“çš„æ–‡ä»¶**ï¼š
- `SingleEngineApp/media_engine_streamlit_app.py`
  - æ–°å¢ `start_research_thread()` (ç¬¬ 263-291 è¡Œ)
  - æ–°å¢ `monitor_research_progress()` (ç¬¬ 294-355 è¡Œ)
  - ä¿®æ”¹ `main()` è°ƒç”¨ç›‘æ§ (ç¬¬ 173-177 è¡Œ)
- `SingleEngineApp/query_engine_streamlit_app.py`
  - æ–°å¢ `start_research_thread()` (ç¬¬ 260-288 è¡Œ)
  - æ–°å¢ `monitor_research_progress()` (ç¬¬ 291-352 è¡Œ)
  - ä¿®æ”¹ `main()` è°ƒç”¨ç›‘æ§ (ç¬¬ 169-173 è¡Œ)

**ä¿®å¤æ•ˆæœ**ï¼š
- âœ… MediaEngine åœæ­¢åæ­£å¸¸æ˜¾ç¤ºé‡æ–°è¿è¡ŒæŒ‰é’®
- âœ… QueryEngine åœæ­¢åæ­£å¸¸æ˜¾ç¤ºé‡æ–°è¿è¡ŒæŒ‰é’®
- âœ… ä¸‰ä¸ªå¼•æ“ä½¿ç”¨å®Œå…¨ä¸€è‡´çš„æ¶æ„
- âœ… ç”¨æˆ·ä½“éªŒå¤§å¹…æ”¹å–„

### åœæ­¢å“åº”æ—¶é—´

**å®æµ‹æ•°æ®**ï¼š
- **MediaEngine**: ~1ç§’ï¼ˆè¿æ°”å¥½ï¼Œåœ¨æœç´¢é˜¶æ®µåœæ­¢ï¼‰âš¡
- **QueryEngine**: ~34ç§’ï¼ˆåœ¨ Qwen-Plus LLM è°ƒç”¨ä¸­ï¼‰â³
- **InsightEngine**: ~59ç§’ï¼ˆåœ¨ Kimi-k2-thinking LLM è°ƒç”¨ä¸­ï¼‰â³

**å“åº”æ—¶é—´å–å†³äº**ï¼š
1. å½“å‰æ“ä½œç±»å‹ï¼ˆæœç´¢ vs LLM è°ƒç”¨ï¼‰
2. ä½¿ç”¨çš„ LLM æ¨¡å‹ï¼ˆQwen-Plus vs Kimi-k2-thinkingï¼‰
3. åœæ­¢æ—¶æœºï¼ˆLLM è°ƒç”¨å‰ vs è°ƒç”¨ä¸­ï¼‰

### å·²çŸ¥é™åˆ¶

**LLM è°ƒç”¨æœŸé—´åœæ­¢å“åº”æ…¢**ï¼š
- **åŸå› **ï¼šLLM API è°ƒç”¨æ˜¯åŒæ­¥é˜»å¡æ“ä½œ
- **å½±å“**ï¼šåœ¨ LLM è°ƒç”¨æœŸé—´ç‚¹å‡»åœæ­¢ï¼Œéœ€è¦ç­‰å¾… LLM å®Œæˆ
  - Qwen-Plus: 20-40ç§’
  - Qwen-VL-Plus: 10-30ç§’
  - Kimi-k2-thinking: 40-120ç§’
- **çŠ¶æ€**ï¼šæŠ€æœ¯é™åˆ¶ï¼Œæ— æ³•åœ¨é˜»å¡æœŸé—´æ£€æµ‹åœæ­¢ä¿¡å·
- **å½“å‰**ï¼šå¯æ¥å—ï¼Œç”¨æˆ·çœ‹åˆ°"æ­£åœ¨åœæ­¢ä»»åŠ¡ï¼Œè¯·ç¨å€™..."æç¤º

**æœªæ¥ä¼˜åŒ–æ–¹å‘**ï¼š
1. ä½¿ç”¨å¼‚æ­¥ LLM è°ƒç”¨ï¼ˆéœ€è¦å¤§é‡é‡æ„ï¼‰
2. æ·»åŠ è¶…æ—¶æœºåˆ¶ï¼ˆå¯èƒ½ä¸¢å¤±éƒ¨åˆ†å“åº”ï¼‰
3. ä½¿ç”¨å¯ä¸­æ–­çš„ HTTP å®¢æˆ·ç«¯ï¼ˆå¤æ‚åº¦é«˜ï¼‰
4. åˆ‡æ¢åˆ°æ›´å¿«çš„ LLM æ¨¡å‹ï¼ˆå¦‚ Qwen-Plus è€Œä¸æ˜¯ Kimi-k2-thinkingï¼‰

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [InsightEngine æœ¬åœ°èˆ†æƒ…æ•°æ®åº“æŠ€æœ¯æ€»ç»“](./InsightEngineæœ¬åœ°èˆ†æƒ…æ•°æ®åº“æŠ€æœ¯æ€»ç»“.md)
- [MediaEngine å¤šæ¨¡æ€æœç´¢æŠ€æœ¯æ€»ç»“](./MediaEngineå¤šæ¨¡æ€æœç´¢æŠ€æœ¯æ€»ç»“.md)
- [QueryEngine æ–°é—»æŸ¥è¯¢æŠ€æœ¯æ€»ç»“](./QueryEngineæ–°é—»æŸ¥è¯¢æŠ€æœ¯æ€»ç»“.md)
- [Stop æŒ‰é’®é—®é¢˜åˆ†æä¸è§£å†³æ–¹æ¡ˆ](./StopæŒ‰é’®é—®é¢˜åˆ†æä¸è§£å†³æ–¹æ¡ˆ.md)
- [Streamlit å®˜æ–¹æ–‡æ¡£ - Session State](https://docs.streamlit.io/library/api-reference/session-state)
- [Python Threading å®˜æ–¹æ–‡æ¡£](https://docs.python.org/3/library/threading.html)

---

**æ–‡æ¡£ç‰ˆæœ¬**: 3.0  
**æœ€åæ›´æ–°**: 2025-11-12 22:42  
**ç»´æŠ¤è€…**: BettaFish Team

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### v3.0 (2025-11-12 22:42)
- âœ… å®Œæˆ MediaEngine å’Œ QueryEngine çš„æ¶æ„é‡æ„
- âœ… æ·»åŠ åœæ­¢å“åº”æ—¶é—´è¯¦ç»†åˆ†æï¼ˆå®æµ‹æ•°æ®ï¼‰
- âœ… æ›´æ–°æŠ€æœ¯å®ç°ç« èŠ‚ï¼Œè¯´æ˜æ¶æ„é‡æ„ç»†èŠ‚
- âœ… æ·»åŠ ä¸‰ä¸ªå¼•æ“çš„åœæ­¢å“åº”æ—¶é—´å¯¹æ¯”è¡¨
- âœ… è¯´æ˜ LLM è°ƒç”¨æœŸé—´åœæ­¢å“åº”æ…¢çš„æŠ€æœ¯åŸå› 

### v2.0 (2025-11-12)
- âœ… ä¿®å¤ MediaEngine å’Œ QueryEngine çš„åœæ­¢åŠŸèƒ½
- âœ… å°†é”™è¯¯æ£€æŸ¥ç§»åˆ°å¾ªç¯å¤–éƒ¨
- âœ… ç»Ÿä¸€ä¸‰ä¸ªå¼•æ“çš„è¡Œä¸º

### v1.0 (2025-11-11)
- âœ… åˆå§‹ç‰ˆæœ¬
- âœ… ä¿®å¤ InsightEngine çš„åœæ­¢åŠŸèƒ½
