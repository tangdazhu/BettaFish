# Forum Engine 工作原理简明指南

> BettaFish 微舆系统核心创新功能

## 🎯 什么是 Forum Engine？

**Forum Engine（论坛引擎）** 充当"论坛主持人"角色，协调多个 AI Agent 之间的交流和协作。

## 🤔 为什么需要它？

### 单一 LLM 的问题
- ❌ 思维固化
- ❌ 观点重复
- ❌ 视角单一
- ❌ 缺乏批判性

### Forum Engine 的优势
- ✅ 多视角分析
- ✅ 观点碰撞
- ✅ 主持引导
- ✅ 集体智能

## 🏗️ 工作架构

```
用户提问
    ↓
并行启动 3 个 Agent
    ↓
┌─────────┬─────────┬─────────┐
│ Query   │ Media   │ Insight │
│ Agent   │ Agent   │ Agent   │
└────┬────┴────┬────┴────┬────┘
     │         │         │
     └────────┬┴─────────┘
              ↓
      Forum Engine
      (主持人监控)
              ↓
      生成总结和引导
              ↓
      Agent 调整方向
              ↓
      循环迭代深化
              ↓
      Report Agent
      生成最终报告
```

## 🔄 工作流程

### 1. 初始阶段
- 3个 Agent 并行启动
- 各自使用专属工具搜索
- 发布初步发现到论坛

### 2. 论坛协作（循环）
- **Forum Engine 监控**：实时监控各 Agent 日志
- **提取关键信息**：识别重要发现
- **主持人总结**：LLM 分析并生成引导
- **Agent 调整**：根据引导深入研究

### 3. 最终整合
- Report Agent 收集论坛讨论
- 生成综合分析报告

## 💬 实际案例

### 用户输入
```
"分析武汉大学的品牌声誉"
```

### 第一轮发现

**Query Agent**:
```
发现微博热搜 #武汉大学樱花季#
讨论量10万+，主要关注校园美景
```

**Media Agent**:
```
抖音相关视频500万播放
内容类型：风景70%、生活20%、学术10%
```

**Insight Agent**:
```
数据库查询：近7天2000+条
情感分析：正面65%、中性30%、负面5%
```

### 主持人总结

```
📊 综合分析：

发现：
1. 传播热点集中在校园美景（樱花季）
2. 学术内容传播较少（仅10%）
3. 整体舆情正面，但有5%负面声音

🎯 建议深入调研：
1. 负面舆情的具体来源？
2. 学术成果为何传播效果不佳？
3. 不同平台用户画像差异？
4. 与竞品高校的对比？
```

### 第二轮深入

**Query Agent**（根据引导）:
```
搜索"武汉大学 学术成果"
发现：学术新闻主要在官方渠道
```

**Media Agent**（根据引导）:
```
分析B站学术视频
发现：播放量低，用户觉得"太硬核"
```

**Insight Agent**（根据引导）:
```
分析负面评论：
40%校园管理、30%学费住宿、30%就业
```

### 最终报告
整合所有发现，生成深度分析报告

## 🔧 技术实现

### 代码结构
```
ForumEngine/
├── monitor.py     # 监控Agent日志
└── llm_host.py    # 主持人LLM
```

### 核心逻辑

**monitor.py** - 监控器
- 读取各 Agent 日志
- 提取关键信息
- 发布到论坛
- 触发主持人总结

**llm_host.py** - 主持人
- 分析论坛讨论
- 生成综合总结
- 提出引导建议

**forum_reader.py** - Agent工具
- 读取主持人总结
- 读取其他Agent发现
- 调整研究策略

## ⚙️ 配置说明

### .env 配置
```bash
# Forum Host LLM配置
FORUM_HOST_API_KEY=sk-your-key
FORUM_HOST_BASE_URL=https://dashscope.aliyuncs.com/compatible-mode/v1
FORUM_HOST_MODEL_NAME=qwen-max
```

### 推荐模型
- **qwen-max**: 中文理解强（推荐）
- **gpt-4**: 综合能力强
- **claude-3-opus**: 长文本处理好

## 📊 效果对比

| 指标 | 单一LLM | Forum Engine | 提升 |
|------|---------|--------------|------|
| 分析深度 | ⭐⭐ | ⭐⭐⭐⭐⭐ | +150% |
| 覆盖面 | ⭐⭐ | ⭐⭐⭐⭐ | +80% |
| 发现盲点 | ⭐ | ⭐⭐⭐⭐⭐ | +200% |
| 报告质量 | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ | +60% |

## 🌟 核心价值

1. **突破单一LLM局限** - 多Agent协作产生集体智能
2. **模拟专家组讨论** - 还原真实的专家会议过程
3. **动态优化路径** - 根据讨论调整研究方向
4. **提升分析质量** - 多维度、深层次、全覆盖

## 🎓 最佳实践

### 配置建议
```bash
# 主持人使用大参数模型
FORUM_HOST_MODEL_NAME=qwen-max

# 各Agent使用特长模型
QUERY_ENGINE_MODEL_NAME=deepseek-chat  # 快速
MEDIA_ENGINE_MODEL_NAME=qwen-vl-max    # 多模态
INSIGHT_ENGINE_MODEL_NAME=qwen-max     # 深度
```

### 使用技巧
1. 合理设置触发阈值
2. 保持日志清晰
3. 定期清理历史
4. 监控总结质量

## 🔮 未来展望

- 更智能的主持人（识别矛盾、主动质疑）
- 更丰富的协作模式（Agent直接对话）
- 可视化论坛（实时展示讨论过程）
- 扩展到其他领域（金融、医疗、法律）

## 📚 参考资源

- 项目地址：https://github.com/666ghj/BettaFish
- 完整文档：[README.md](../README.md)
- AI网关对比：[AI_Gateway_Comparison.md](./AI_Gateway_Comparison.md)

---

**Forum Engine 让 AI 从"单打独斗"变成"团队协作"，这正是 BettaFish 的核心创新！**

---

文档维护：BettaFish 项目组 | 更新：2025-11-11

# Forum Engine 架构与工作原理详解

> BettaFish 微舆系统核心创新功能  
> 更新时间：2025-11-11

## 概述

**Forum Engine（论坛引擎）** 是 BettaFish 微舆系统的核心创新功能，它充当" 论坛主持人\的角色，协调多个 AI Agent 之间的交流和协作。

## 为什么需要 Forum Engine？

### 传统单一 LLM 的局限性
- 思维固化，容易陷入固定思维模式
- 多轮对话容易产生重复观点 
- 缺乏多维度分析能力
- 难以自我质疑和修正

### Forum Engine 的解决方案
- 多个 Agent 独立思考，各有专长
- 通过\论坛\机制交流观点
- AI 主持人引导深度讨论
- 产生超越单一模型的洞察

