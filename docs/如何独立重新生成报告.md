# å¦‚ä½•ç‹¬ç«‹é‡æ–°ç”ŸæˆæŠ¥å‘Š

## ğŸ“‹ æ¦‚è¿°

å½“æ‚¨å·²ç»è¿è¡Œäº† Query Engineã€Media Engine å’Œ Insight Engine ç”Ÿæˆäº†å„è‡ªçš„æŠ¥å‘Šåï¼Œå¯ä»¥ä½¿ç”¨ç‹¬ç«‹è„šæœ¬é‡æ–°ç”Ÿæˆæœ€ç»ˆçš„ç»¼åˆæŠ¥å‘Šï¼Œè€Œæ— éœ€é‡æ–°è¿è¡Œä¸‰ä¸ªå¼•æ“ã€‚

è¿™åœ¨ä»¥ä¸‹åœºæ™¯ç‰¹åˆ«æœ‰ç”¨ï¼š
- âœ… ä¿®æ”¹äº† Report Engine çš„æ¨¡å‹é…ç½®ï¼ˆå¦‚ä» `qwen-plus` æ”¹ä¸º `qwen-long`ï¼‰
- âœ… è°ƒæ•´äº†æŠ¥å‘Šæ¨¡æ¿
- âœ… ä¿®å¤äº†æŠ¥å‘Šç”Ÿæˆçš„ bug
- âœ… æƒ³è¦ä½¿ç”¨ä¸åŒçš„æŠ¥å‘Šæ ¼å¼

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æ–¹æ³• 1ï¼šä½¿ç”¨æ‰¹å¤„ç†æ–‡ä»¶ï¼ˆæ¨èï¼‰

**æœ€ç®€å•çš„æ–¹å¼**ï¼š

```bash
# åŒå‡»è¿è¡Œ
regenerate_report.bat
```

æˆ–åœ¨å‘½ä»¤è¡Œä¸­ï¼š

```bash
cd d:\Python-Learning\bettafish
regenerate_report.bat
```

---

### æ–¹æ³• 2ï¼šç›´æ¥è¿è¡Œ Python è„šæœ¬

```bash
# 1. æ¿€æ´»ç¯å¢ƒ
conda activate bettafish

# 2. è¿è¡Œè„šæœ¬
python regenerate_report.py
```

---

## ğŸ“‚ å‰ææ¡ä»¶

**å¿…é¡»å·²ç»å­˜åœ¨ä»¥ä¸‹æ–‡ä»¶**ï¼š

1. **Query Engine æŠ¥å‘Š**
   - ç›®å½•ï¼š`query_engine_streamlit_reports/`
   - æ–‡ä»¶ï¼š`deep_search_report_*.md`

2. **Media Engine æŠ¥å‘Š**
   - ç›®å½•ï¼š`media_engine_streamlit_reports/`
   - æ–‡ä»¶ï¼š`deep_search_report_*.md`

3. **Insight Engine æŠ¥å‘Š**
   - ç›®å½•ï¼š`insight_engine_streamlit_reports/`
   - æ–‡ä»¶ï¼š`deep_search_report_*.md`

4. **è®ºå›æ—¥å¿—ï¼ˆå¯é€‰ï¼‰**
   - æ–‡ä»¶ï¼š`logs/forum.log`

---

## ğŸ”„ å·¥ä½œæµç¨‹

è„šæœ¬ä¼šè‡ªåŠ¨æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š

```
[1/5] æŸ¥æ‰¾æœ€æ–°çš„å¼•æ“æŠ¥å‘Š
      â†“
      è‡ªåŠ¨åœ¨ä¸‰ä¸ªç›®å½•ä¸­æŸ¥æ‰¾æœ€æ–°çš„ .md æ–‡ä»¶
      
[2/5] åŠ è½½æŠ¥å‘Šå†…å®¹
      â†“
      è¯»å–ä¸‰ä¸ªå¼•æ“çš„æŠ¥å‘Šå†…å®¹
      
[3/5] åŠ è½½è®ºå›æ—¥å¿—
      â†“
      è¯»å– ForumEngine çš„è®¨è®ºè®°å½•
      
[4/5] å‡†å¤‡ç”ŸæˆæŠ¥å‘Š
      â†“
      ä»æ–‡ä»¶åä¸­æå–æŸ¥è¯¢ä¸»é¢˜
      
[5/5] ç”Ÿæˆæœ€ç»ˆæŠ¥å‘Š
      â†“
      è°ƒç”¨ ReportAgent ç”Ÿæˆ HTML æŠ¥å‘Š
      ä¿å­˜åˆ° final_reports/ ç›®å½•
```

---

## ğŸ“Š è¾“å‡ºç¤ºä¾‹

```
============================================================
ç‹¬ç«‹é‡æ–°ç”ŸæˆæŠ¥å‘Šå·¥å…·
============================================================

[1/5] æŸ¥æ‰¾æœ€æ–°çš„å¼•æ“æŠ¥å‘Š...
æ‰¾åˆ° query æœ€æ–°æŠ¥å‘Š: deep_search_report_AI_Agent_20251111_175110.md
æ‰¾åˆ° media æœ€æ–°æŠ¥å‘Š: deep_search_report_AI_Agent_20251111_173757.md
æ‰¾åˆ° insight æœ€æ–°æŠ¥å‘Š: deep_search_report_AI_Agent_20251111_175712.md
âœ“ æ‰¾åˆ° 3 ä¸ªå¼•æ“æŠ¥å‘Š

[2/5] åŠ è½½æŠ¥å‘Šå†…å®¹...
å·²åŠ è½½æŠ¥å‘Š: deep_search_report_AI_Agent_20251111_175110.md, é•¿åº¦: 7693 å­—ç¬¦
å·²åŠ è½½æŠ¥å‘Š: deep_search_report_AI_Agent_20251111_173757.md, é•¿åº¦: 4701 å­—ç¬¦
å·²åŠ è½½æŠ¥å‘Š: deep_search_report_AI_Agent_20251111_175712.md, é•¿åº¦: 12598 å­—ç¬¦
âœ“ æ‰€æœ‰æŠ¥å‘Šå†…å®¹å·²åŠ è½½

[3/5] åŠ è½½è®ºå›æ—¥å¿—...
å·²åŠ è½½è®ºå›æ—¥å¿—ï¼Œé•¿åº¦: 170950 å­—ç¬¦
âœ“ è®ºå›æ—¥å¿—å·²åŠ è½½ (170950 å­—ç¬¦)

[4/5] å‡†å¤‡ç”ŸæˆæŠ¥å‘Š...
æŸ¥è¯¢ä¸»é¢˜: AI_Agentåœ¨è¿‡å»1ä¸ªæœˆé‡Œé¢çš„æœ€æ–°çš„å‘å±•è¶‹åŠ¿

[5/5] ç”Ÿæˆæœ€ç»ˆæŠ¥å‘Š...
æ³¨æ„: è¿™å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿæ—¶é—´...

[ç”Ÿæˆè¿‡ç¨‹æ—¥å¿—...]

============================================================
âœ… æŠ¥å‘Šç”ŸæˆæˆåŠŸï¼
============================================================

æŠ¥å‘Šå·²ä¿å­˜åˆ°: final_reports/
HTML é•¿åº¦: 45231 å­—ç¬¦

æœ€æ–°æŠ¥å‘Š: final_report__20251111_220530.html
å®Œæ•´è·¯å¾„: D:\Python-Learning\bettafish\final_reports\final_report__20251111_220530.html
```

---

## âš™ï¸ é…ç½®è¯´æ˜

### ä½¿ç”¨ qwen-long æ¨¡å‹ï¼ˆæ¨èï¼‰

åœ¨ `.env` æ–‡ä»¶ä¸­é…ç½®ï¼š

```bash
# Report Engine é…ç½®
REPORT_ENGINE_MODEL_NAME=qwen-long  # æ”¯æŒé•¿æ–‡æœ¬è¾“å‡ºï¼ˆ~30K tokensï¼‰
```

### æ¨¡å‹å¯¹æ¯”

| æ¨¡å‹ | æœ€å¤§è¾“å‡º | é€‚ç”¨åœºæ™¯ | æ¨èåº¦ |
|------|---------|---------|--------|
| `qwen-plus` | ~6K tokens | æ™®é€šå¯¹è¯ | âŒ ä¸é€‚åˆæŠ¥å‘Šç”Ÿæˆ |
| `qwen-long` | ~30K tokens | **é•¿æ–‡æœ¬ç”Ÿæˆ** | âœ… **å¼ºçƒˆæ¨è** |
| `qwen-max` | ~8K tokens | é«˜è´¨é‡å¯¹è¯ | âš ï¸ è¾“å‡ºé•¿åº¦æœ‰é™ |
| `gemini-1.5-pro` | ~8K tokens | é«˜è´¨é‡å†™ä½œ | âœ… æ¨è |

---

## ğŸ”§ å¸¸è§é—®é¢˜

### 1. æ‰¾ä¸åˆ°å¼•æ“æŠ¥å‘Š

**é”™è¯¯**ï¼š
```
âŒ é”™è¯¯: éœ€è¦3ä¸ªå¼•æ“æŠ¥å‘Šï¼Œä½†åªæ‰¾åˆ° 1 ä¸ª
```

**è§£å†³**ï¼š
- ç¡®ä¿å·²ç»è¿è¡Œè¿‡ä¸‰ä¸ªå¼•æ“ï¼ˆQueryã€Mediaã€Insightï¼‰
- æ£€æŸ¥å¯¹åº”ç›®å½•ä¸‹æ˜¯å¦æœ‰ `.md` æ–‡ä»¶
- é‡æ–°è¿è¡Œç¼ºå¤±çš„å¼•æ“

---

### 2. æŠ¥å‘Šå†…å®¹ä¸å®Œæ•´

**é—®é¢˜**ï¼šç”Ÿæˆçš„ HTML åªæœ‰æ ‡é¢˜ï¼Œæ²¡æœ‰å†…å®¹

**åŸå› **ï¼šä½¿ç”¨äº† `qwen-plus` æ¨¡å‹ï¼Œè¾“å‡ºé•¿åº¦é™åˆ¶

**è§£å†³**ï¼š
1. ä¿®æ”¹ `.env` æ–‡ä»¶ï¼š
   ```bash
   REPORT_ENGINE_MODEL_NAME=qwen-long
   ```

2. é‡æ–°è¿è¡Œè„šæœ¬ï¼š
   ```bash
   regenerate_report.bat
   ```

---

### 3. è®ºå›æ—¥å¿—ä¸å­˜åœ¨

**è­¦å‘Š**ï¼š
```
è®ºå›æ—¥å¿—ä¸å­˜åœ¨: logs/forum.log
```

**å½±å“**ï¼šæŠ¥å‘Šä»ä¼šç”Ÿæˆï¼Œä½†ç¼ºå°‘è®ºå›è®¨è®ºæ•°æ®

**è§£å†³**ï¼š
- å¦‚æœä¸éœ€è¦è®ºå›æ•°æ®ï¼Œå¯ä»¥å¿½ç•¥
- å¦‚æœéœ€è¦ï¼Œç¡®ä¿ ForumEngine å·²è¿è¡Œå¹¶ç”Ÿæˆæ—¥å¿—

---

## ğŸ“ æ–‡ä»¶ç»“æ„

```
bettafish/
â”œâ”€â”€ regenerate_report.py          # é‡æ–°ç”ŸæˆæŠ¥å‘Šè„šæœ¬
â”œâ”€â”€ regenerate_report.bat         # Windows æ‰¹å¤„ç†æ–‡ä»¶
â”œâ”€â”€ query_engine_streamlit_reports/
â”‚   â””â”€â”€ deep_search_report_*.md   # Query Engine æŠ¥å‘Š
â”œâ”€â”€ media_engine_streamlit_reports/
â”‚   â””â”€â”€ deep_search_report_*.md   # Media Engine æŠ¥å‘Š
â”œâ”€â”€ insight_engine_streamlit_reports/
â”‚   â””â”€â”€ deep_search_report_*.md   # Insight Engine æŠ¥å‘Š
â”œâ”€â”€ logs/
â”‚   â””â”€â”€ forum.log                 # è®ºå›æ—¥å¿—
â””â”€â”€ final_reports/
    â”œâ”€â”€ final_report_*.html       # ç”Ÿæˆçš„æœ€ç»ˆæŠ¥å‘Š
    â””â”€â”€ report_state_*.json       # æŠ¥å‘ŠçŠ¶æ€
```

---

## ğŸ’¡ é«˜çº§ç”¨æ³•

### æŒ‡å®šç‰¹å®šçš„æŠ¥å‘Šæ–‡ä»¶

å¦‚æœä¸æƒ³ä½¿ç”¨æœ€æ–°çš„æŠ¥å‘Šï¼Œå¯ä»¥ä¿®æ”¹ `regenerate_report.py`ï¼š

```python
# åœ¨ main() å‡½æ•°ä¸­æ‰‹åŠ¨æŒ‡å®šæ–‡ä»¶
query_report = load_report_content(Path('query_engine_streamlit_reports/specific_report.md'))
media_report = load_report_content(Path('media_engine_streamlit_reports/specific_report.md'))
insight_report = load_report_content(Path('insight_engine_streamlit_reports/specific_report.md'))
```

### ä½¿ç”¨è‡ªå®šä¹‰æ¨¡æ¿

```python
# åœ¨ agent.generate_report() è°ƒç”¨ä¸­æ·»åŠ è‡ªå®šä¹‰æ¨¡æ¿
html_content = agent.generate_report(
    query=query,
    reports=reports,
    forum_logs=forum_logs,
    custom_template="æ‚¨çš„è‡ªå®šä¹‰æ¨¡æ¿å†…å®¹",  # æ·»åŠ è¿™ä¸€è¡Œ
    save_report=True
)
```

---

## ğŸ¯ æœ€ä½³å®è·µ

1. **ä¿®æ”¹é…ç½®åé‡æ–°ç”Ÿæˆ**
   - ä¿®æ”¹ `.env` ä¸­çš„æ¨¡å‹é…ç½®
   - è¿è¡Œ `regenerate_report.bat`
   - æ— éœ€é‡æ–°è¿è¡Œä¸‰ä¸ªå¼•æ“

2. **æ‰¹é‡æµ‹è¯•ä¸åŒæ¨¡å‹**
   - ä¿®æ”¹ `REPORT_ENGINE_MODEL_NAME`
   - è¿è¡Œè„šæœ¬
   - æ¯”è¾ƒä¸åŒæ¨¡å‹çš„è¾“å‡ºè´¨é‡

3. **ä¿ç•™å†å²æŠ¥å‘Š**
   - ç”Ÿæˆçš„æŠ¥å‘Šä¼šè‡ªåŠ¨ä¿å­˜åˆ° `final_reports/`
   - æ–‡ä»¶ååŒ…å«æ—¶é—´æˆ³ï¼Œä¸ä¼šè¦†ç›–
   - å¯ä»¥å¯¹æ¯”ä¸åŒç‰ˆæœ¬çš„æŠ¥å‘Š

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼š
1. æŸ¥çœ‹ `logs/report.log` è·å–è¯¦ç»†æ—¥å¿—
2. æ£€æŸ¥ `.env` é…ç½®æ˜¯å¦æ­£ç¡®
3. ç¡®è®¤ä¸‰ä¸ªå¼•æ“çš„æŠ¥å‘Šæ–‡ä»¶å­˜åœ¨
4. è”ç³»æŠ€æœ¯æ”¯æŒï¼šğŸ“§ 670939375@qq.com

---

**åˆ›å»ºæ—¶é—´**ï¼š2025-11-11  
**æœ€åæ›´æ–°**ï¼š2025-11-11  
**ç‰ˆæœ¬**ï¼šv1.0
